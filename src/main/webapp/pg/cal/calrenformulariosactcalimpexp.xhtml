<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml"
	xmlns:ui="http://java.sun.com/jsf/facelets"
	xmlns:f="http://java.sun.com/jsf/core"
	xmlns:h="http://java.sun.com/jsf/html"
	xmlns:p="http://primefaces.org/ui">

<h:body>
	<ui:composition template="/WEB-INF/templates/master.xhtml">
		<ui:define name="content">
			<h:form id="frm">
				<h3 style="color: #003778; text-align: center">
					#{consultaCalRenFormulariosImpExpCalBean.empresa.nombre}</h3>
				<p:growl id="mensaje" autoUpdate="false" showSummary="false"
					showDetail="true" />
				<p:panelGrid columns="2" columnClasses="topAligned"
					style="text-align: left;width:100%">
					<p:panel id="pn_form_impexp" style="width:100%;height:500px;">
						<p:panelGrid columns="6" columnClasses="topAligned"
							style="text-align: left;width:100%">
							<f:facet name="header">
								<h:outputText value="INFORMACIÓN DE LA CALIFICACIÓN" />
							</f:facet>
							<p:outputLabel styleClass="especialstrong" value="Secuencia:" />
							<p:outputLabel
								value="#{consultaCalRenFormulariosImpExpCalBean.calRen.secuencia}" />

							<p:outputLabel styleClass="especialstrong"
								value="Fecha Renovación" />
							<p:outputLabel
								value="#{consultaCalRenFormulariosImpExpCalBean.calRen.fecha_renovacion}" />

							<p:outputLabel styleClass="especialstrong"
								value="Fecha Caducidad" />
							<p:outputLabel
								value="#{consultaCalRenFormulariosImpExpCalBean.calRen.fecha_caducidad}" />

							<p:outputLabel styleClass="especialstrong" value="Permiso ARCSA" />
							<p:outputLabel
								value="#{consultaCalRenFormulariosImpExpCalBean.calRenActCal.permiso_arcsa}" />

							<p:outputLabel styleClass="especialstrong"
								value="Código de operador - Importador" />
							<p:outputLabel
								value="#{consultaCalRenFormulariosImpExpCalBean.calRenActCal.codigo_operador_importacion}" />

							<p:outputLabel styleClass="especialstrong"
								value="Código de operador - Exportador" />
							<p:outputLabel
								value="#{consultaCalRenFormulariosImpExpCalBean.calRenActCal.codigo_operador_exportacion}" />
						</p:panelGrid>
						<!-- FILTRAR POR EXPORTADOR O IMPORTADOR LAS SUSTANCIAS -->

						<p:panelGrid columns="6" columnClasses="topAligned"
							style="text-align: left;width:100%">

							<f:facet name="header">
								<h:outputText value="TIPO DE ACTIVIDAD" />
							</f:facet>

							<p:selectOneMenu id="cboTipo"
								value="#{consultaCalRenFormulariosImpExpCalBean.tipoIE.impexp_actividad_codigo}"
								converter="omnifaces.SelectItemsConverter" autoWidth="false"
								style="width:350px;" filter="true" required="true"
								requiredMessage="Requerido el tipo">
								
								<f:selectItems
									value="#{consultaCalRenFormulariosImpExpCalBean.listaTipoIE}"
									var="c" itemLabel="#{c.impexp_actividad_nombre}  "
									itemValue="#{c}" />
								<p:ajax event="change"
									listener="#{consultaCalRenFormulariosImpExpCalBean.cargarListaSustancias(consultaCalRenFormulariosImpExpCalBean.tipoIE.calren_id, consultaCalRenFormulariosImpExpCalBean.tipoIE.impexp_actividad_codigo)}"
									update="frm:dt_formulario,frm:dt_form" />
							</p:selectOneMenu>
						</p:panelGrid>

						<!-- LISTAR SUSTANCIAS -->

						<p:panelGrid columns="2" columnClasses="topAligned"
							style="text-align: left;width:100%">
							<p:panel id="pn_form_impexp1" style="width:100%;height:400px;">
								<p:dataTable id="dt_formulario" var="e" lazy="true"
									value="#{consultaCalRenFormulariosImpExpCalBean.listaSustancias}"
									selectionMode="single"
									selection="#{consultaCalRenFormulariosImpExpCalBean.sustancias}"
									rowKey="#{e.calrensusact_id}" rows="5" paginator="true"
									paginatorTemplate="{CurrentPageReport} {FirstPageLink} {PreviousPageLink} {PageLinks} {NextPageLink} {LastPageLink} {RowsPerPageDropdown}"
									rowsPerPageTemplate="5,10,15" sortOrder="descending"
									paginatorPosition="top" scrollable="true">

									<p:ajax event="rowSelect"
										listener="#{consultaCalRenFormulariosImpExpCalBean.onRowSelect}"
										update="frm:dt_form" />
									<p:ajax event="rowUnselect"
										listener="#{consultaCalRenFormulariosImpExpCalBean.onRowUnselect}"
										update="frm:dt_form" />

									<f:facet name="header">
										<h:outputText
											value="SUSTANCIAS PARA LA ACTIVIDAD DE IMPORTADOR/EXPORTADOR" />
									</f:facet>

									<p:column headerText="Sustancias" style="width:80px">
										<p:outputLabel
											value="#{e.sus_nombre}">
										</p:outputLabel>
									</p:column>

								</p:dataTable>
							</p:panel>
							<p:panel id="pn_form_impexp2" style="width:100%;height:400px;">
								<p:dataTable id="dt_form" var="x" styleClass="centered"
									lazy="true"
									value="#{consultaCalRenFormulariosImpExpCalBean.listaPaises}"
									rows="5" paginator="true"
									paginatorTemplate="{CurrentPageReport} {FirstPageLink} {PreviousPageLink} {PageLinks} {NextPageLink} {LastPageLink} {RowsPerPageDropdown}"
									rowsPerPageTemplate="5,10,15" sortOrder="descending"
									paginatorPosition="top" scrollable="true">

									<f:facet name="header">
										<h:outputText value="PAISES POR SUSTANCIAS PARA LA ACTIVIDAD" />
									</f:facet>
									<p:column headerText="Pais" style="width:80px">
										<p:outputLabel value="#{x.pais_nombre}">
										</p:outputLabel>
									</p:column>
							
								</p:dataTable>
							</p:panel>
						</p:panelGrid>
					</p:panel>
					<p:panel id="pn_opc_form_impexp"
						style="width:100%;height:500px;position:relative;">
						<p:commandButton id="btnRegresar" value="Regresar"
							style="width:120px" icon="ui-icon-circle-arrow-w"
							actionListener="#{consultaCalRenFormulariosImpExpCalBean.irFormularios()}" />
					</p:panel>
				</p:panelGrid>
			</h:form>

		</ui:define>

	</ui:composition>
</h:body>
</html>
